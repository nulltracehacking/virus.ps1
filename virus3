@echo off
title OMEGA-7 // CRYPTOLOCK Protocol
color 0C
echo ========================================
echo    OMEGA-7 CRYPTOLOCK UTILITY
echo    [SECURITY LEVEL: OMEGA RED]
echo ========================================
echo.

:menu
echo [1] Lock/Encrypt Files in Directory
echo [2] Unlock/Decrypt Files in Directory
echo [3] Exit
echo.
set /p choice="Select Operation [1-3]: "

if "%choice%"=="1" goto encrypt
if "%choice%"=="2" goto decrypt
if "%choice%"=="3" exit /b
echo Invalid selection. & pause & cls & goto menu

:encrypt
echo.
set /p target_dir="Enter Directory Path to Lock: "
if not exist "%target_dir%" echo Directory not found. & pause & goto menu
echo.
echo [STATUS] Locking files with AES-256...
echo.
cd /d "%target_dir%"
for %%f in (*) do (
    if not "%%f"=="CRYPTOLOCK.bat" (
        echo   Processing: %%f
        openssl enc -aes-256-cbc -salt -in "%%f" -out "%%f.encrypted" -pass pass:nullTrace 2>nul
        if exist "%%f.encrypted" (
            del "%%f"
            echo   [OK] %%f -> %%f.encrypted
        ) else (
            echo   [FAILED] %%f
        )
    )
)
echo.
echo [MISSION COMPLETE] All target files locked.
echo [WARNING] Originals purged. Key required for restoration.
pause
cls
goto menu

:decrypt
echo.
set /p target_dir="Enter Directory Path to Unlock: "
if not exist "%target_dir%" echo Directory not found. & pause & goto menu
echo.
set /p key="Enter Decryption Key: "
if not "%key%"=="nullTrace" (
    echo [ACCESS DENIED] Invalid key. Operation aborted.
    pause
    goto menu
)
echo.
echo [STATUS] Unlocking files...
echo.
cd /d "%target_dir%"
for %%f in (*.encrypted) do (
    echo   Processing: %%f
    openssl enc -aes-256-cbc -d -salt -in "%%f" -out "%%~nf" -pass pass:%key% 2>nul
    if exist "%%~nf" (
        del "%%f"
        echo   [OK] %%f -> %%~nf
    ) else (
        echo   [FAILED] %%f - Potentially corrupted or wrong key.
    )
)
echo.
echo [MISSION COMPLETE] Files restored.
pause
cls
goto menu